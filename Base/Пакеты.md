15.07.2024 23:50
Tags: #info

---
# Пакеты
**Пакет** — это единица компиляции, пространства имён и импорта.
Проще говоря, пакет — это набор файлов с исходным кодом из одной папки проекта.

В каждом файле исходный код на языке Go должен начинаться с объявления пакета: ключевого слова `package` и имени пакета.

```go
package main

import "fmt"

func main() {
    fmt.Println(`Hello, world!`)
} 
```


В директории у всех файлов должно быть одинаковое имя пакета, потому что компилятор будет обрабатывать сразу все файлы директории (если не указать на конкретный) и при разных именах пакетов возникнет ошибка. Однако из этого правила есть исключение — файлы, название которых заканчивается на `_test.go`, могут иметь другое имя пакета, так как они игнорируются при сборке программы.

Подход «одна директория — один пакет» упрощает работу и дальнейшую поддержку программ. Строго рекомендуется, чтобы название пакета совпадало с именем папки, так как с ними будет проще работать.

Если нужно создать исполняемый файл, у пакета должно быть имя `main` и одноимённая функция в одном из файлов. В остальных случаях, если пакет будет использоваться как библиотека, желательно, чтобы имя пакета отражало его назначение.

### Как лучше называть пакет и его элементы

Вместо создания одного большого универсального пакета старайтесь разбивать код на мелкие пакеты и присваивать каждому из них понятное имя.

1. Записывайте имя пакета строчными буквами. Коротко и информативно.
2. Подбирайте пакету уникальное имя в рамках репозитория. В противном случае при импорте нескольких пакетов с одинаковыми именами придётся использовать алиасы.
3. Не пишите в имени пакета общие слова: `util`, `base`, `tools`, `lib`, `common`. 
4. Не используйте множественное число. Но есть исключения: пакеты `strings`, `bytes`, `errors` в стандартной библиотеке Go названы так, чтобы избежать конфликта с типами. Иногда использовать множественное число допустимо — например, если нужно показать, что пакет `handlers` содержит несколько обработчиков.
5. Не используйте слова из названия пакета при именовании экспортируемых объектов. Например, если есть пакет `md` для работы с форматом Markdown, функцию конвертации в HTML можно так и назвать — `HTML`. Не стоит называть функцию `MarkdownToHTML`: имя пакета уже указывает на то, с чем вы работаете.

Cтрогих правил по организации директорий нет, но лучше начать путь с домена или имени автора, чтобы избежать конфликтов имён при публичном использовании пакетов. Например, вы можете создать директорию `golang` и размещать там все Go-проекты, для личных закрытых проектов создать отдельную поддиректорию, а публичные размещать сразу в поддиректории соответствующего репозитория. В этом случае пакеты с GitHub будут расположены в поддиректориях вида `github.com/author/packagename`.

### Порядок импорта

Рассмотрим подробнее, как выполняется импорт пакетов.

1. При компиляции программы компилятор начинает с пакета `main`. Если в `main` есть импорты каких-либо пакетов, то он переходит к ним и компилирует их, до тех пор пока не скомпилируются все необходимые пакеты для сборки программы.
2. Затем компилятор компилирует пакет `main` и собирает основное приложение, а далее в процессе выполнения программы произойдёт следующее: 1. В том порядке, в котором пакеты были проимпортированы, будут инициализироваться переменные пакета. 2. После будут выполнены функции `init()` внутри каждого пакета. Функций `init()` может быть несколько, и они выполнятся в том порядке, в котором были объявлены. 3. И после их выполнения наступит очередь функции `main`.

Таким образом, часть кода по инициализации может быть выполнена ещё до запуска основной программы. Это очень удобная особенность, и в процессе работы вы, скорее всего, с ней столкнётесь.

---
### Zero-links:
[[00 Backend]] [[00 Golang]]

---
### Links:
